<html>
<head>
<style>
  @page {
    size: A4;
    margin: 20mm;
    @bottom-right {
      content: "Halaman " counter(page) " dari " counter(pages);
      font-size: 10px;
      font-family: Arial, sans-serif;
    }
  }
  body { 
    font-family: Arial, sans-serif; 
    font-size: 12px; 
  }
  h3 {
    text-align: center;
    max-width: 80%;
    margin: auto;
    line-height: 1.3;
  }
  hr.custom {
    border: none;
    height: 1px;
    background-color: black;
    margin: 10px 50px;
  }
  .section-title {
    text-align: center;
    font-weight: bold;
    text-transform: uppercase;
    margin-top: 10px;
  }
  .total-data {
    font-weight: bold;
    text-align: left;
    margin-top: 5px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 5px;
    page-break-inside: auto;
  }
  th, td {
    border: 1px solid black;
    padding: 4px;
    text-align: center;
  }
  .signature-block {
    text-align: right;
    margin-top: 40px;
  }
  .signature-img {
    height: 60px;
  }
  .name {
    text-align: right;
    margin-bottom: 0;
  }
  .npm {
    display: block;
    text-align: right;
    padding-right: 8.7px;
    margin-top: 0px;
  }
</style>
</head>
<body>

<h3>
Prediksi Harga Saham di Indonesia Menggunakan Metode<br>
Bidirectional Gated Recurrent Unit (BiGRU) dengan<br>
Pendekatan Distributed Machine Learning<br>
Operations
</h3>

<hr class="custom">
<br>
<div class="section-title">LAPORAN INFORMASI HISTORIKAL</div>
<div class="section-title">PT {{ short_name }} - {{ symbol }}</div>
<br>
<br>
<div class="total-data">Total Data: {{ historicals|length }}</div>

<table>
    <tr>
      <th>No</th>
      <th>Tanggal</th>
      <th><p style="transform: skewX(-20deg); display: inline-block;">Open</p></th>
      <th><p style="transform: skewX(-20deg); display: inline-block;">High</p></th>
      <th><p style="transform: skewX(-20deg); display: inline-block;">Low</p></th>
      <th><p style="transform: skewX(-20deg); display: inline-block;">Close</p></th>
      <th><p style="transform: skewX(-20deg); display: inline-block;">Volume</p></th>
    </tr>
    {% for row in historicals %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ row.full_date }}</td>
      <td>{{ ("Rp {:,.2f}".format(row.open)).replace(",", "X").replace(".", ",").replace("X", ".") }}</td>
      <td>{{ ("Rp {:,.2f}".format(row.high)).replace(",", "X").replace(".", ",").replace("X", ".") }}</td>
      <td>{{ ("Rp {:,.2f}".format(row.low)).replace(",", "X").replace(".", ",").replace("X", ".") }}</td>
      <td>{{ ("Rp {:,.2f}".format(row.close)).replace(",", "X").replace(".", ",").replace("X", ".") }}</td>
      <td>{{ ("%.3f"|format(row.volume)).rstrip('0').rstrip('.') }}</td>
    </tr>
    {% endfor %}
</table>

<div class="signature-block">
  Jakarta, {{ full_date }}
  <br>Mengetahui,
  <br><img src="./assets/signature.png" class="signature-img">
  <br><span class="name">{{ full_name }}</span>
  <span class="npm">NPM: {{ npm_numbers }}</span>
</div>

</body>
</html>
